(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[260],{8841:(e,a,s)=>{Promise.resolve().then(s.bind(s,5288))},5288:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>j});var t=s(5155),n=s(2115);s(1071);var r=s(3084),i=s(9757),l=s(5055);let o=e=>{let{item:a,onEdit:s,onDelete:n,onAssign:o,onAdd:c,onReport:d}=e,{id:m,name:u,stock:h,model:p,brand:x,unitprice:g,imageurl:j,codigoitem:b}=a;return(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"imageContainer",children:(0,t.jsx)("img",{src:"https://v14m7300-4000.brs.devtunnels.ms".concat(j),alt:u,className:"item-image"})}),(0,t.jsxs)("div",{className:"details",children:[(0,t.jsx)("h3",{className:"title",children:u}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"C\xf3digo:"})," ",b]})," ",(0,t.jsxs)("div",{className:"row",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Stock:"})," ",h]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Precio Unitario:"})," ",(0,t.jsxs)("span",{className:"price",children:[g," Bs"]})]})]}),(0,t.jsxs)("div",{className:"row",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Modelo:"})," ",p]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Marca:"})," ",x]})]}),(0,t.jsxs)("div",{className:"form-buttons-grid",children:[(0,t.jsxs)("div",{className:"button-row",children:[(0,t.jsxs)("button",{className:"button add-button",onClick:()=>c(a),children:[(0,t.jsx)(i.g,{icon:l.QLR})," A\xf1adir"]}),(0,t.jsxs)("button",{className:"button edit-button",onClick:()=>s(m),children:[(0,t.jsx)(i.g,{icon:l.MT7})," Editar"]})]}),(0,t.jsxs)("div",{className:"button-row",children:[(0,t.jsxs)("button",{className:"button assign-button",onClick:()=>o(m),children:[(0,t.jsx)(i.g,{icon:l.nWR})," Asignar"]}),(0,t.jsxs)("button",{className:"button delete-button",onClick:()=>n(m),children:[(0,t.jsx)(i.g,{icon:l.BeE})," Eliminar"]})]}),(0,t.jsx)("div",{className:"button-row",children:(0,t.jsxs)("button",{className:"button report-button",onClick:()=>d(m),children:[(0,t.jsx)(i.g,{icon:l.h8M})," Reportes"]})})]})]}),(0,t.jsxs)("div",{className:"qr-container",children:[(0,t.jsx)(r.X,{id:"qr-".concat(m),value:b||"".concat(m),size:128,style:{display:"none"}}),(0,t.jsxs)("button",{className:"button qr-button",onClick:()=>{let e=document.getElementById("qr-".concat(m)).toDataURL("image/png"),a=document.createElement("a");a.href=e,a.download="item-".concat(b||u,"-qr.png"),a.click()},title:"Descargar c\xf3digo QR",children:[(0,t.jsx)(i.g,{icon:l.Yop})," Descargar QR"]})]})]})};var c=s(5370);function d(e){let{onClose:a,onItemRegistered:s}=e,[r,i]=(0,n.useState)({name:"",codigoitem:"",stock:"0",model:"",size:"",serialNumber:"",unitprice:"",categoryId:"",storeId:"",branchId:"",brand:"",images:[]}),[l,o]=(0,n.useState)([]),[d,m]=(0,n.useState)([]),[u,h]=(0,n.useState)([]),[p,x]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=async()=>{try{let{status:e,data:a}=await (0,c.p9)();200===e&&m(a)}catch(e){console.error("Error al cargar las sucursales:",e)}finally{x(!1)}};(async()=>{try{let{status:e,data:a}=await (0,c.bW)(2);200===e&&o(a)}catch(e){console.error("Error al cargar las categor\xedas:",e)}finally{x(!1)}})(),e()},[]);let g=e=>{let{name:a,value:s}=e.target;i(e=>({...e,[a]:""===s?["stock","categoryId","storeId","branchId"].includes(a)?null:"":s})),"branchId"===a&&(j(s),i(e=>({...e,storeId:""})))},j=async e=>{try{let{status:a,data:s}=await (0,c.Dv)(e);200===a&&h(s)}catch(e){console.error("Error al cargar los almacenes:",e)}},b=e=>{i(a=>({...a,images:a.images.filter((a,s)=>s!==e)}))},v=async e=>{var t,n,i,l;e.preventDefault();let o={...r,model:(null===(t=r.model)||void 0===t?void 0:t.trim())||"Sin Modelo",brand:(null===(n=r.brand)||void 0===n?void 0:n.trim())||"Sin Marca",size:(null===(i=r.size)||void 0===i?void 0:i.trim())||"N/A",serialNumber:(null===(l=r.serialNumber)||void 0===l?void 0:l.trim())||"000000"},d=new FormData;Object.entries(o).forEach(e=>{let[a,s]=e;"images"!==a&&null!==s&&d.append(a,s)}),r.images.forEach(e=>{d.append("images",e.file)});try{let e=await (0,c.wE)(d);201===e.status?(alert("Registro exitoso"),s(),a()):alert("Hubo un error al registrar la m\xe1quina.")}catch(e){console.error("Error al enviar los datos:",e),alert("Hubo un error al enviar los datos.")}};return(0,t.jsxs)("div",{className:"create-item-container",children:[(0,t.jsx)("h2",{className:"form-title",children:"REGISTRO DE ITEM"}),(0,t.jsxs)("form",{className:"form",onSubmit:v,children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:["Nombre: ",(0,t.jsx)("span",{className:"required",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"name",value:r.name,onChange:g,className:"form-input",required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:["C\xf3digo del \xcdtem: ",(0,t.jsx)("span",{className:"required",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"codigoitem",value:r.codigoitem,onChange:g,className:"form-input",required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:["Precio Unitario: ",(0,t.jsx)("span",{className:"required",children:"*"})]}),(0,t.jsx)("input",{type:"number",name:"unitprice",value:r.unitprice,onChange:g,className:"form-input",required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Modelo:"}),(0,t.jsx)("input",{type:"text",name:"model",value:r.model,onChange:g,className:"form-input"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Marca:"}),(0,t.jsx)("input",{type:"text",name:"brand",value:r.brand,onChange:g,className:"form-input"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Tama\xf1o:"}),(0,t.jsx)("input",{type:"text",name:"size",value:r.size,onChange:g,className:"form-input"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"N\xfamero de serie:"}),(0,t.jsx)("input",{type:"text",name:"serialNumber",value:r.serialNumber,onChange:g,className:"form-input"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:["Categor\xeda: ",(0,t.jsx)("span",{className:"required",children:"*"})]}),(0,t.jsxs)("select",{name:"categoryId",value:r.categoryId,onChange:g,className:"form-select",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Selecciona una categor\xeda"}),l.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:["Sucursales: ",(0,t.jsx)("span",{className:"required",children:"*"})]}),(0,t.jsxs)("select",{name:"branchId",value:r.branchId,onChange:g,className:"form-select",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Selecciona una sucursal"}),d.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),r.branchId&&(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:["Almac\xe9n: ",(0,t.jsx)("span",{className:"required",children:"*"})]}),(0,t.jsxs)("select",{name:"storeId",value:r.storeId,onChange:g,className:"form-select",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Selecciona un almac\xe9n"}),u.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Im\xe1genes:"}),(0,t.jsx)("input",{type:"file",name:"images",className:"form-input",accept:"image/*",onChange:e=>{let a=Array.from(e.target.files).map(e=>({file:e,url:URL.createObjectURL(e)}));i(e=>({...e,images:[...e.images,...a]}))},multiple:!0})]}),(0,t.jsx)("div",{className:"image-preview-container",children:r.images.map((e,a)=>(0,t.jsxs)("div",{className:"image-preview-item",children:[(0,t.jsx)("img",{src:e.url,alt:"Preview ".concat(a),className:"image-preview"}),(0,t.jsx)("button",{type:"button",className:"remove-image-button",onClick:()=>b(a),children:"X"})]},a))}),(0,t.jsxs)("div",{className:"form-buttons",children:[(0,t.jsx)("button",{type:"submit",className:"form-button form-button-primary",children:"Registrar"}),(0,t.jsx)("button",{type:"button",className:"form-button form-button-secondary",onClick:a,children:"Cancelar"})]})]})]})}function m(e){let{itemId:a,onClose:s,onItemUpdated:r}=e,[i,l]=(0,n.useState)({name:"",model:"",size:"",serialNumber:"",unitprice:"",categoryId:"",storeId:"",branchId:"",brand:"",codigoitem:""}),[o,d]=(0,n.useState)([]),[m,u]=(0,n.useState)([]),[h,p]=(0,n.useState)([]),[x,g]=(0,n.useState)([]),[j,b]=(0,n.useState)([]),[v,f]=(0,n.useState)([]);(0,n.useEffect)(()=>{(async()=>{try{let{status:e,data:s}=await (0,c.Gq)(a);if(200===e){let e=Array.isArray(s)?s[0]:s;l({name:e.name||"",model:e.model||"",size:e.size||"",serialNumber:e.serialnumber||"",unitprice:e.unitprice||"",categoryId:e.categoryid||"",storeId:e.storeid||"",branchId:e.branchid||"",brand:e.brand||"",codigoitem:e.codigoitem||""}),g(e.images||[])}}catch(e){console.error("Error al cargar el \xedtem:",e)}})()},[a]),(0,n.useEffect)(()=>{(async()=>{try{let e=await (0,c.p9)(),a=await (0,c.bW)(2);200===e.status&&d(e.data),200===a.status&&u(a.data)}catch(e){console.error("Error al cargar categor\xedas o sucursales:",e)}})()},[]),(0,n.useEffect)(()=>{(async()=>{if(i.branchId)try{let{status:e,data:a}=await (0,c.Dv)(i.branchId);200===e&&p(a)}catch(e){console.error("Error al cargar los almacenes:",e)}})()},[i.branchId]);let N=e=>{let{name:a,value:s}=e.target;("codigoitem"!==a||/^[a-zA-Z0-9\-]*$/.test(s))&&(l(e=>({...e,[a]:s})),"branchId"===a&&l(e=>({...e,storeId:""})))},y=e=>{b(a=>[...a,e]),g(a=>a.filter(a=>a!==e))},C=e=>{f(a=>a.filter((a,s)=>s!==e))},S=async e=>{var t,n,l,o;e.preventDefault();let d={...i,model:(null===(t=i.model)||void 0===t?void 0:t.trim())||"Sin Modelo",brand:(null===(n=i.brand)||void 0===n?void 0:n.trim())||"Sin Marca",size:(null===(l=i.size)||void 0===l?void 0:l.trim())||"N/A",serialNumber:(null===(o=i.serialNumber)||void 0===o?void 0:o.trim())||"000000"},m=new FormData;for(let e in d)m.append(e,d[e]);v.forEach(e=>m.append("images",e)),m.append("imagesToDelete",JSON.stringify(j));try{let e=await (0,c.fk)(a,m);200===e.status||204===e.status?(alert("Actualizaci\xf3n exitosa"),r(),s()):alert("Error al actualizar el \xedtem: "+e.statusText)}catch(e){console.error("Error al actualizar los datos:",e),alert("Hubo un error al actualizar los datos.")}},w={name:"Nombre",model:"Modelo",size:"Tama\xf1o",serialNumber:"N\xfamero de serie",unitprice:"Precio unitario",brand:"Marca"};return(0,t.jsxs)("div",{className:"create-item-container",children:[(0,t.jsx)("h2",{className:"form-title",children:"ACTUALIZAR ITEM"}),(0,t.jsxs)("form",{className:"form",onSubmit:S,encType:"multipart/form-data",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:["C\xf3digo del \xedtem: ",(0,t.jsx)("span",{className:"required",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"codigoitem",value:i.codigoitem,onChange:N,className:"form-input",required:!0})]}),Object.entries(i).map(e=>{let[a,s]=e;return["categoryId","storeId","branchId","codigoitem"].includes(a)?null:(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("label",{className:"form-label",children:[w[a]||a,":"]}),(0,t.jsx)("input",{type:"text",name:a,value:s,onChange:N,className:"form-input"})]},a)}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Categor\xeda:"}),(0,t.jsxs)("select",{name:"categoryId",value:i.categoryId,onChange:N,className:"form-input",children:[(0,t.jsx)("option",{value:"",children:"Seleccione una categor\xeda"}),m.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Sucursal:"}),(0,t.jsxs)("select",{name:"branchId",value:i.branchId,onChange:N,className:"form-input",children:[(0,t.jsx)("option",{value:"",children:"Seleccione una sucursal"}),o.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Almac\xe9n:"}),(0,t.jsxs)("select",{name:"storeId",value:i.storeId,onChange:N,className:"form-input",children:[(0,t.jsx)("option",{value:"",children:"Seleccione un almac\xe9n"}),h.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Im\xe1genes actuales:"}),(0,t.jsx)("div",{className:"image-preview-container",children:x.map(e=>(0,t.jsxs)("div",{className:"image-preview-item",children:[(0,t.jsx)("img",{src:"https://v14m7300-4000.brs.devtunnels.ms".concat(e),alt:"img",className:"preview-img",width:"100"}),(0,t.jsx)("button",{type:"button",className:"remove-image-button",onClick:()=>y(e),children:"X"})]},e))})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label",children:"Agregar nuevas im\xe1genes:"}),(0,t.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>f(a=>[...a,...Array.from(e.target.files)])}),(0,t.jsx)("div",{className:"image-preview-container",children:v.map((e,a)=>(0,t.jsxs)("div",{className:"image-preview-item",children:[(0,t.jsx)("img",{src:URL.createObjectURL(e),alt:"preview-".concat(a),className:"preview-img",width:"100"}),(0,t.jsx)("button",{type:"button",className:"remove-image-button",onClick:()=>C(a),children:"X"})]},a))})]}),(0,t.jsxs)("div",{className:"form-buttons",children:[(0,t.jsx)("button",{type:"submit",className:"form-button form-button-primary",children:"Actualizar"}),(0,t.jsx)("button",{type:"button",className:"form-button form-button-secondary",onClick:s,children:"Cancelar"})]})]})]})}function u(e){let{itemId:a,onClose:s,onItemDeleted:n}=e,r=async e=>{e.preventDefault();try{let e=await (0,c.LD)(a);200===e.status||204===e.status?(alert("Registro Eliminado"),n(),s()):alert("Error al eliminar la m\xe1quina. C\xf3digo de estado: "+e.status)}catch(e){console.error("Error al eliminar la m\xe1quina:",e),alert("Error al eliminar la m\xe1quina. Ver la consola para m\xe1s detalles.")}};return(0,t.jsxs)("div",{className:"create-item-container",children:[(0,t.jsx)("h2",{className:"form-title",children:"\xbfDesea Eliminar el Registro?"}),(0,t.jsx)("form",{className:"form",onSubmit:r,children:(0,t.jsxs)("div",{className:"form-buttons",children:[(0,t.jsx)("button",{type:"submit",className:"form-button form-button-primary",children:"Aceptar"}),(0,t.jsx)("button",{type:"button",className:"form-button form-button-secondary",onClick:s,children:"Cancelar"})]})})]})}function h(e){let{item:a,onClose:s,onItemAssigned:r}=e,[i,l]=(0,n.useState)([]),[o,c]=(0,n.useState)(""),[d,m]=(0,n.useState)(1),[u,h]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("https://v14m7300-4000.brs.devtunnels.ms/activos"),a=await e.json();l(a)}catch(e){console.error("Error al cargar usuarios:",e),alert("Error al obtener la lista de usuarios.")}})()},[]);let p=async()=>{if(!o){alert("Selecciona un empleado.");return}if(d<=0){alert("La cantidad debe ser mayor a 0.");return}if(d>a.stock){alert("No hay suficiente stock disponible.");return}let e={userid:parseInt(o),observation:u||"Asignaci\xf3n de ".concat(d," unidad(es) de ").concat(a.name),items:[{itemid:a.id,quantity:d}]};try{let a=await fetch("https://v14m7300-4000.brs.devtunnels.ms/api/transactions/assign",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok)alert("\xcdtem asignado correctamente ✅"),r(),s();else{let e=await a.json();console.error(e),alert("Error al asignar el \xedtem.")}}catch(e){console.error(e),alert("Error de conexi\xf3n con el servidor.")}};return(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Asignaci\xf3n de \xcdtem"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"15px",marginBottom:"15px"},children:[(0,t.jsx)("img",{src:"https://v14m7300-4000.brs.devtunnels.ms".concat(a.imageurl),alt:a.name,style:{width:"100px",borderRadius:"8px"}}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Nombre:"})," ",a.name]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Stock:"})," ",a.stock]})]})]}),(0,t.jsx)("label",{children:"Cantidad a asignar:"}),(0,t.jsx)("input",{type:"number",min:"1",max:a.stock,value:d,onChange:e=>m(Number(e.target.value)),style:{width:"100%",padding:"8px",marginBottom:"12px"}}),(0,t.jsx)("label",{children:"Selecciona un empleado:"}),(0,t.jsxs)("select",{value:o,onChange:e=>c(e.target.value),style:{width:"100%",padding:"8px",marginBottom:"12px"},children:[(0,t.jsx)("option",{value:"",children:"-- Seleccionar empleado --"}),i.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," ",e.lastname]},e.id))]}),(0,t.jsx)("label",{children:"Observaci\xf3n (opcional):"}),(0,t.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),placeholder:"Ej. Entregado para uso en taller",rows:"3",style:{width:"100%",padding:"8px",marginBottom:"15px",resize:"vertical"}}),(0,t.jsx)("button",{onClick:p,style:{marginRight:"10px"},children:"Confirmar Asignaci\xf3n"}),(0,t.jsx)("button",{onClick:s,children:"Cancelar"})]})}function p(e){let{item:a,onClose:s,onItemUpdated:r}=e,[i,l]=(0,n.useState)(1),[o,c]=(0,n.useState)(""),[d,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(1);sessionStorage.getItem("userId"),(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("https://v14m7300-4000.brs.devtunnels.ms/movements/".concat(a.id)),s=(await e.json()).filter(e=>"entrada"===e.movementtype);m(s)}catch(e){console.error("Error al cargar historial de stock:",e)}})()},[a.id]);let p=async()=>{if(i<=0){alert("La cantidad debe ser mayor a 0.");return}let e=sessionStorage.getItem("userId");if(!e){alert("Error: No se pudo obtener el usuario logueado.");return}let t={userid:Number(e),observation:o||"Ingreso de ".concat(i," unidad(es) de ").concat(a.name),items:[{itemid:a.id,quantity:i}]};try{let e=await fetch("https://v14m7300-4000.brs.devtunnels.ms/api/transactions/entry",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(e.ok)alert("Stock a\xf1adido correctamente ✅"),r(),s();else{let a=await e.json();console.error(a),alert("Error al a\xf1adir stock.")}}catch(e){console.error(e),alert("Error de conexi\xf3n con el servidor.")}},x=Math.ceil(d.length/5),g=d.slice((u-1)*5,5*u);return(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Ingreso de Stock"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"15px",marginBottom:"15px"},children:[(0,t.jsx)("img",{src:"https://v14m7300-4000.brs.devtunnels.ms".concat(a.imageurl),alt:a.name,style:{width:"100px",borderRadius:"8px"}}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Nombre:"})," ",a.name]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Stock actual:"})," ",a.stock]})]})]}),(0,t.jsx)("label",{children:"Cantidad a ingresar:"}),(0,t.jsx)("input",{type:"number",min:"1",value:i,onChange:e=>l(Number(e.target.value)),style:{width:"100%",padding:"8px",marginBottom:"12px"}}),(0,t.jsx)("label",{children:"Observaci\xf3n (opcional):"}),(0,t.jsx)("textarea",{value:o,onChange:e=>c(e.target.value),placeholder:"Ej. Reposici\xf3n por compra",rows:"3",style:{width:"100%",padding:"8px",marginBottom:"15px",resize:"vertical"}}),(0,t.jsx)("button",{onClick:p,style:{marginRight:"10px"},children:"Confirmar Ingreso"}),(0,t.jsx)("button",{onClick:s,children:"Cancelar"}),(0,t.jsx)("h4",{style:{marginTop:"30px"},children:"Historial de entradas"}),0===d.length?(0,t.jsx)("p",{children:"No hay movimientos de entrada registrados."}):(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"10px"},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{borderBottom:"2px solid #ccc",backgroundColor:"#f2f2f2"},children:[(0,t.jsx)("th",{style:{padding:"8px",textAlign:"left"},children:"\uD83D\uDCC5 Fecha"}),(0,t.jsx)("th",{style:{padding:"8px",textAlign:"center"},children:"\uD83D\uDCE6 Cantidad"}),(0,t.jsx)("th",{style:{padding:"8px",textAlign:"left"},children:"\uD83D\uDCDD Descripci\xf3n"})]})}),(0,t.jsx)("tbody",{children:g.map(e=>(0,t.jsxs)("tr",{style:{borderBottom:"1px solid #e0e0e0"},children:[(0,t.jsx)("td",{style:{padding:"6px"},children:new Date(e.createdat).toLocaleString("es-BO",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}),(0,t.jsx)("td",{style:{padding:"6px",textAlign:"center",fontWeight:"bold"},children:e.quantity}),(0,t.jsx)("td",{style:{padding:"6px"},children:e.description})]},e.id))}),x>1&&(0,t.jsxs)("div",{className:"pagination",children:[(0,t.jsx)("button",{disabled:1===u,onClick:()=>h(u-1),children:"◀"}),Array.from({length:x},(e,a)=>(0,t.jsx)("button",{className:u===a+1?"active":"",onClick:()=>h(a+1),children:a+1},a+1)),(0,t.jsx)("button",{disabled:u===x,onClick:()=>h(u+1),children:"▶"})]})]})]})}function x(e){let{itemId:a,onClose:s}=e,[r,i]=(0,n.useState)([]),[l,o]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{(async()=>{try{let e=await (0,c.lX)(a);i(e)}catch(e){console.error("Error al obtener reporte de movimientos:",e)}finally{o(!1)}})()},[a]),(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("button",{className:"close-button",onClick:s,children:"\xd7"}),(0,t.jsxs)("h2",{children:["Reporte de Movimientos del \xcdtem #",a]}),l?(0,t.jsx)("p",{children:"Cargando..."}):0===r.length?(0,t.jsx)("p",{children:"No se encontraron movimientos."}):(0,t.jsxs)("table",{style:{width:"100%",marginTop:"1rem",borderCollapse:"collapse"},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{backgroundColor:"#f4f4f4",borderBottom:"1px solid #ccc"},children:[(0,t.jsx)("th",{style:{padding:"8px"},children:"Fecha"}),(0,t.jsx)("th",{style:{padding:"8px"},children:"Tipo"}),(0,t.jsx)("th",{style:{padding:"8px"},children:"Cantidad"}),(0,t.jsx)("th",{style:{padding:"8px"},children:"Total acumulado"}),(0,t.jsx)("th",{style:{padding:"8px"},children:"Descripci\xf3n"}),(0,t.jsx)("th",{style:{padding:"8px"},children:"Usuario"})]})}),(0,t.jsx)("tbody",{children:r.map((e,a)=>(0,t.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,t.jsx)("td",{style:{padding:"6px"},children:new Date(e.transactiondate).toLocaleString("es-BO",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,t.jsx)("td",{style:{padding:"6px"},children:e.movementtype}),(0,t.jsx)("td",{style:{padding:"6px",textAlign:"center"},children:e.quantity}),(0,t.jsx)("td",{style:{padding:"6px",textAlign:"center",fontWeight:"bold"},children:e.current_total}),(0,t.jsx)("td",{style:{padding:"6px"},children:e.description}),(0,t.jsx)("td",{style:{padding:"6px"},children:e.user_name})]},a))})]})]})})}s(5527),s(5572);var g=s(4060);function j(){let[e,a]=(0,n.useState)(!1),[s,r]=(0,n.useState)(!1),[j,b]=(0,n.useState)(!1),[v,f]=(0,n.useState)(!1),[N,y]=(0,n.useState)(null),[C,S]=(0,n.useState)(0),[w,E]=(0,n.useState)([]),[A,k]=(0,n.useState)(!0),[I,D]=(0,n.useState)(null),[R,q]=(0,n.useState)(""),[T,L]=(0,n.useState)(!1),[z,M]=(0,n.useState)(null),[O,U]=(0,n.useState)(!1),B=async()=>{try{let e=await (0,c.JS)();if(e.data){let a=e.data.sort((e,a)=>{let s=new Date(e.updated_at||e.created_at);return new Date(a.updated_at||a.created_at)-s});E(a)}else E([])}catch(e){D(e.message)}finally{k(!1)}};(0,n.useEffect)(()=>{B()},[]);let P=e=>{y(e),r(!0)},F=e=>{y(e),b(!0)},J=e=>{let a=w.find(a=>a.id===e);a&&(y(e),S(a.stock),f(!0))},X=e=>{M(e),L(!0)},_=e=>{y(e),U(!0)};return(0,t.jsx)(g.A,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{children:(0,t.jsx)("h1",{className:"titles",children:"ITEMS"})}),(0,t.jsxs)("div",{className:"almacen-header",children:[(0,t.jsx)("button",{onClick:()=>a(!0),className:"new-item-button",children:"Nuevo Item"}),(0,t.jsxs)("div",{className:"search-container",children:[(0,t.jsx)(i.g,{icon:l.MjD,className:"search-icon"}),(0,t.jsx)("input",{type:"text",className:"search-bar",placeholder:"Buscar...",value:R,onChange:e=>q(e.target.value)})]})]}),e&&(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("button",{onClick:()=>a(!1),className:"close-button",children:"\xd7"}),(0,t.jsx)(d,{onClose:()=>a(!1),onItemRegistered:B})]})}),s&&(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("button",{onClick:()=>r(!1),className:"close-button",children:"\xd7"}),(0,t.jsx)(m,{itemId:N,onClose:()=>r(!1),onItemUpdated:B})]})}),v&&(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("button",{onClick:()=>f(!1),className:"close-button",children:"\xd7"}),(0,t.jsx)(h,{item:w.find(e=>e.id===N),onClose:()=>f(!1),onItemAssigned:B})]})}),j&&(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("button",{onClick:()=>b(!1),className:"close-button",children:"\xd7"}),(0,t.jsx)(u,{itemId:N,onClose:()=>b(!1),onItemDeleted:B})]})}),T&&z&&(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("button",{onClick:()=>L(!1),className:"close-button",children:"\xd7"}),(0,t.jsx)(p,{item:z,onClose:()=>L(!1),onItemUpdated:B})]})}),O&&N&&(0,t.jsx)(x,{itemId:N,onClose:()=>U(!1)}),(0,t.jsx)("div",{className:"outerContainer",children:(0,t.jsx)("div",{className:"innerContainer",children:w.filter(e=>e.name.toLowerCase().includes(R.toLowerCase())||e.model.toLowerCase().includes(R.toLowerCase())||e.brand.toLowerCase().includes(R.toLowerCase())).map(e=>(0,t.jsx)(o,{item:e,onEdit:P,onDelete:F,onAssign:J,onAdd:X,onReport:_},e.id))})})]})})}},4060:(e,a,s)=>{"use strict";s.d(a,{A:()=>x});var t=s(5155),n=s(6046),r=s(2115),i=s(8173),l=s.n(i),o=s(9757),c=s(5055),d=s(5565);let m={src:"/_next/static/media/logo.3adaab63.png",height:100,width:100,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAARVBMVEX9/PzZdXj////9+fn55+hMaXHwz9D//////v7//f7svb/219v46On509X////RUlngkpXdgYb+8vPOTlX92dzVZGrprrIgseqOAAAADXRSTlMu+bXs/QD+rvH5/urq2zavewAAAAlwSFlzAAALEwAACxMBAJqcGAAAAD9JREFUeJwFwQkCgCAIAME1QdDCq+P/T20G5aj1QCE/IuFgke6RtuExxzu34/1bq/WMVSnFu8EZpckFirkb+gNMYwIfjEe+YgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8};s(3999);var u=s(6699),h=s.n(u);function p(e){let{children:a}=e,s=(0,n.usePathname)(),i=(0,n.useRouter)(),[u,p]=(0,r.useState)(""),[x,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=sessionStorage.getItem("name"),a=sessionStorage.getItem("lastname");e&&a&&p("".concat(e.toUpperCase()," ").concat(a.toUpperCase()))},[]);let j=()=>{window.innerWidth<768&&g(!1)};return(0,t.jsxs)("div",{className:"layout ".concat(h().className),children:[(0,t.jsxs)("div",{className:"header",children:[(0,t.jsxs)("div",{className:"header-left",children:[(0,t.jsx)(o.g,{icon:c.ckx,className:"menu-icon",onClick:()=>g(!x)}),(0,t.jsx)(d.default,{src:m,alt:"Logo Tornemec",className:"logo"}),(0,t.jsxs)("span",{className:"company-name",children:["TORNEMEC",(0,t.jsx)("small",{children:" SRL"})]})]}),(0,t.jsxs)("div",{className:"header-right",children:[(0,t.jsx)("span",{className:"user-name",children:u}),(0,t.jsx)(o.g,{icon:c.X46,className:"icon"}),(0,t.jsxs)("div",{className:"logout-container",onClick:()=>{confirm("\xbfSeguro que deseas cerrar sesi\xf3n?")&&(sessionStorage.clear(),i.push("/"))},children:[(0,t.jsx)(o.g,{icon:c.GxD,className:"logout-icon"}),(0,t.jsx)("span",{className:"logout-text",children:"CERRAR SESI\xd3N"})]})]})]}),(0,t.jsxs)("div",{className:"content",children:[(0,t.jsx)("div",{className:"sidebar ".concat(x?"open":""),children:(0,t.jsx)("div",{className:"fixed",children:(0,t.jsx)("nav",{children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{className:"sidebar-item ".concat("/inventory"===s?"active":""),children:(0,t.jsxs)(l(),{href:"/inventory",onClick:j,children:[(0,t.jsx)(o.g,{icon:c.KTq,className:"iconSidebar"}),(0,t.jsx)("span",{children:"Inventario"})]})}),(0,t.jsx)("li",{className:"sidebar-item ".concat("/store"===s?"active":""),children:(0,t.jsxs)(l(),{href:"/store",onClick:j,children:[(0,t.jsx)(o.g,{icon:c.LJS,className:"iconSidebar"}),(0,t.jsx)("span",{children:"Almac\xe9n"})]})}),(0,t.jsx)("li",{className:"sidebar-item ".concat("/users"===s?"active":""),children:(0,t.jsxs)(l(),{href:"/users",onClick:j,children:[(0,t.jsx)(o.g,{icon:c.gdJ,className:"iconSidebar"}),(0,t.jsx)("span",{children:"Usuarios"})]})}),(0,t.jsx)("li",{className:"sidebar-item ".concat("/report"===s?"active":""),children:(0,t.jsxs)(l(),{href:"/report",onClick:j,children:[(0,t.jsx)(o.g,{icon:c.h8M,className:"iconSidebar"}),(0,t.jsx)("span",{children:"Reporte"})]})})]})})})}),(0,t.jsx)("div",{className:"main-content",children:a})]})]})}function x(e){let{children:a}=e,s=(0,n.usePathname)(),i=(0,n.useRouter)(),[l,o]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{sessionStorage.getItem("isAuthenticated")||"/"===s?o(!1):i.push("/")},[s,i]),l)?(0,t.jsx)("p",{children:"Cargando..."}):"/"===s?(0,t.jsx)(t.Fragment,{children:a}):(0,t.jsx)(p,{children:a})}},5370:(e,a,s)=>{"use strict";s.d(a,{$O:()=>I,B_:()=>C,Dv:()=>N,F4:()=>y,Gq:()=>g,JS:()=>x,LD:()=>v,O0:()=>k,Op:()=>S,RG:()=>q,Rn:()=>E,TK:()=>u,bW:()=>f,fk:()=>b,hG:()=>p,ik:()=>T,kg:()=>m,kl:()=>h,lX:()=>D,lo:()=>d,p9:()=>A,pr:()=>c,qZ:()=>R,te:()=>w,wE:()=>j});let t="https://v14m7300-4000.brs.devtunnels.ms";async function n(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(t,"/").concat(e);try{let e=await fetch(s,a),t=await e.json();return{status:e.status,data:t}}catch(e){throw console.error("Error en la solicitud:",e),e}}async function r(e){return n(e,{method:"GET"})}async function i(e,a){let s=a instanceof FormData;return n(e,{method:"POST",headers:s?void 0:{"Content-Type":"application/json"},body:s?a:JSON.stringify(a)})}async function l(e,a){let s=a instanceof FormData;return n(e,{method:"PUT",headers:s?void 0:{"Content-Type":"application/json"},body:s?a:JSON.stringify(a)})}async function o(e){return n(e,{method:"DELETE"})}async function c(e,a){return i("auth/login",{username:e,password:a})}async function d(){return r("activos")}async function m(e){return i("users",e)}let u=(e,a)=>{let s=a instanceof FormData;return fetch("".concat(t,"/users/").concat(e),{method:"PUT",headers:s?void 0:{"Content-Type":"application/json"},body:s?a:JSON.stringify(a)}).then(async e=>{let a=await e.json();if(!e.ok)throw Error(a.message||"Error al actualizar usuario");return{status:e.status,data:a}})},h=async e=>{let a=await fetch("https://v14m7300-4000.brs.devtunnels.ms/users/".concat(e));if(!a.ok)throw Error("No se pudo obtener el usuario");return a.json()};async function p(e){return o("users/".concat(e))}async function x(){return r("items")}async function g(e){return r("items/".concat(e))}async function j(e){return i("items",e)}async function b(e,a){return l("items/".concat(e),a)}async function v(e){return o("items/".concat(e))}async function f(e){return r("categories/".concat(e))}async function N(e){return r("stores/".concat(e))}async function y(){return r("machines")}async function C(e){return r("machines/".concat(e))}async function S(e){return i("machines",e)}async function w(e,a){return l("machines/".concat(e),a)}async function E(e){return o("machines/".concat(e))}async function A(){return r("branches")}async function k(){return r("roles")}let I=async e=>{let{userId:a,month:s,year:t,mode:n}=e,r=new URLSearchParams;a&&r.append("userId",a),s&&"month"===n&&r.append("month",s),t&&r.append("year",t),n&&r.append("mode",n);let i=await fetch("https://v14m7300-4000.brs.devtunnels.ms/api/transactions/report?".concat(r.toString()));if(!i.ok)throw Error("Error al obtener datos");return i.json()},D=async e=>{let a=await fetch("https://v14m7300-4000.brs.devtunnels.ms/api/transactions/report/item-movements?itemId=".concat(e));if(!a.ok)throw Error("No se pudo obtener el reporte de movimientos del \xedtem");return a.json()},R=async e=>{let{userId:a,month:s,year:n,codigoitem:r}=e,i=new URLSearchParams;a&&i.append("userId",a),s&&i.append("month",s),n&&i.append("year",n),r&&i.append("codigoitem",r);let l=await fetch("".concat(t,"/api/transactions/report/user-detailed?").concat(i.toString()));if(!l.ok)throw Error("No se pudo obtener el reporte detallado del usuario");return l.json()},q=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=new URLSearchParams(e).toString(),s=await fetch("https://v14m7300-4000.brs.devtunnels.ms/api/transactions/report/all-transactions?".concat(a));if(!s.ok)throw Error("No se pudo obtener el reporte completo");return s.json()},T=async(e,a,s,t,n)=>{let r=new URLSearchParams;a&&r.append("year",a),s&&r.append("month",s),t&&r.append("userid",t),n&&r.append("branchId",n);let i="https://v14m7300-4000.brs.devtunnels.ms/api/reportes/asignaciones/".concat(e,"?").concat(r.toString()),l=await fetch(i);if(!l.ok)throw Error("No se pudo obtener el reporte de asignaciones");return l.json()}},1071:()=>{},5572:()=>{},5527:()=>{},3999:()=>{}},e=>{var a=a=>e(e.s=a);e.O(0,[777,79,266,738,803,84,441,517,358],()=>a(8841)),_N_E=e.O()}]);