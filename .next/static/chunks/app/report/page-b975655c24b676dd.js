(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81],{1972:(e,n,t)=>{Promise.resolve().then(t.bind(t,9285))},9285:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>c});var a=t(5155),s=t(2115),r=t(5370);t(8019);let i=()=>{let[e,n]=(0,s.useState)({userId:"",type:"",month:"",year:new Date().getFullYear(),mode:"month",codigoitem:"",branchId:""}),[t,i]=(0,s.useState)("resumen"),[o,c]=(0,s.useState)([]),[d,l]=(0,s.useState)(!1),[h,u]=(0,s.useState)([]),m=["","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],p="month"===e.mode,j=()=>{let n=new URLSearchParams;return e.userId&&n.append("userId",e.userId),e.year&&n.append("year",e.year),e.mode&&n.append("mode",e.mode),e.month&&"month"===e.mode&&n.append("month",e.month),e.type&&n.append("type",e.type),e.codigoitem&&n.append("codigoitem",e.codigoitem),e.branchId&&n.append("branchId",e.branchId),n},x=async()=>{l(!0);try{if("detalle"===t){if(!e.userId){alert("Debes ingresar un ID de usuario para ver el detalle."),l(!1);return}let n=await (0,r.qZ)({userId:e.userId,month:e.month,year:e.year,codigoitem:e.codigoitem,branchId:e.branchId});c(n)}else if("completo"===t){let n={userId:e.userId,codigoitem:e.codigoitem,month:e.month,year:e.year,type:e.type,branchId:e.branchId},t=await (0,r.RG)(n);c(t)}else if("asignacion-item"===t){if(!e.codigoitem){alert("Debes ingresar un c\xf3digo de \xedtem."),l(!1);return}let n=await (0,r.ik)(e.codigoitem,e.year,e.month,e.userId,e.branchId);c(n)}else{let{userId:e,codigoitem:n,...t}=Object.fromEntries(j()),a=await (0,r.$O)(t);c(a)}}catch(e){console.error("Error al obtener datos:",e)}finally{l(!1)}},g=t=>{n({...e,[t.target.name]:t.target.value})};return(0,s.useEffect)(()=>{let e=async()=>{try{let e=await fetch("https://v14m7300-4000.brs.devtunnels.ms/branches"),n=await e.json();u(n)}catch(e){console.error("Error al cargar sucursales:",e)}};c([]),x(),e()},[t]),(0,a.jsxs)("div",{className:"report-card",children:[(0,a.jsxs)("div",{className:"report-header",children:[(0,a.jsx)("h2",{className:"report-title",children:"asignacion-item"===t?"Reporte de Asignaci\xf3n por \xcdtem":"detalle"===t?"Reporte Detallado":"completo"===t?"Entradas y Salidas":p?"Reporte de Inversi\xf3n Mensual":"Reporte de Inversi\xf3n Anual"}),(0,a.jsxs)("div",{className:"report-actions",children:[(0,a.jsx)("button",{className:"button",onClick:()=>{let n="",a=new URLSearchParams;if("asignacion-item"===t){if(!e.codigoitem){alert("Debes ingresar un c\xf3digo de \xedtem para descargar el reporte.");return}n="https://v14m7300-4000.brs.devtunnels.ms/api/reportes/asignaciones-excel/".concat(e.codigoitem),e.year&&a.append("year",e.year),e.month&&a.append("month",e.month),e.userId&&a.append("userid",e.userId),e.branchId&&a.append("branchId",e.branchId)}else if("detalle"===t){if(!e.userId){alert("Debes ingresar un ID de usuario para descargar el detalle.");return}n="https://v14m7300-4000.brs.devtunnels.ms/api/transactions/download-user-detailed",a.append("userId",e.userId),e.month&&a.append("month",e.month),e.year&&a.append("year",e.year),e.codigoitem&&a.append("codigoitem",e.codigoitem),e.branchId&&a.append("branchId",e.branchId)}else"completo"===t?(n="https://v14m7300-4000.brs.devtunnels.ms/api/transactions/download-all-transactions",e.userId&&a.append("userId",e.userId),e.month&&a.append("month",e.month),e.year&&a.append("year",e.year),e.codigoitem&&a.append("codigoitem",e.codigoitem),e.type&&a.append("type",e.type),e.branchId&&a.append("branchId",e.branchId)):(n="https://v14m7300-4000.brs.devtunnels.ms/api/transactions/download-report",j().forEach((e,n)=>a.append(n,e)));window.open("".concat(n,"?").concat(a.toString()),"_blank")},children:"Descargar Reporte"}),"asignacion-item"===t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"text",name:"codigoitem",placeholder:"C\xf3digo del \xcdtem",value:e.codigoitem,onChange:g,className:"input"}),(0,a.jsx)("input",{type:"number",name:"userId",placeholder:"ID Usuario (opcional)",value:e.userId,onChange:g,className:"input"}),(0,a.jsxs)("select",{name:"branchId",value:e.branchId||"",onChange:g,className:"input",children:[(0,a.jsx)("option",{value:"",children:"Todas las sucursales"}),h.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,a.jsxs)("select",{name:"month",value:e.month,onChange:g,className:"input",children:[(0,a.jsx)("option",{value:"",children:"Todos los meses"}),m.map((e,n)=>n>0&&(0,a.jsx)("option",{value:n,children:e},n))]})]}),"detalle"===t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"number",name:"userId",placeholder:"ID Usuario",value:e.userId,onChange:g,className:"input"}),(0,a.jsx)("input",{type:"text",name:"codigoitem",placeholder:"C\xf3digo del \xcdtem (opcional)",value:e.codigoitem,onChange:g,className:"input"}),(0,a.jsxs)("select",{name:"month",value:e.month,onChange:g,className:"input",children:[(0,a.jsx)("option",{value:"",children:"Todos los meses"}),m.map((e,n)=>n>0&&(0,a.jsx)("option",{value:n,children:e},n))]})]}),(0,a.jsxs)("select",{value:t,onChange:e=>i(e.target.value),className:"input",children:[(0,a.jsx)("option",{value:"resumen",children:"Resumen"}),(0,a.jsx)("option",{value:"detalle",children:"Detalle"}),(0,a.jsx)("option",{value:"completo",children:"Entradas y Salidas"}),(0,a.jsx)("option",{value:"asignacion-item",children:"Asignaci\xf3n por \xcdtem"})]}),"completo"===t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("select",{name:"type",value:e.type,onChange:g,className:"input",children:[(0,a.jsx)("option",{value:"",children:"Todos"}),(0,a.jsx)("option",{value:"entrada",children:"Entradas"}),(0,a.jsx)("option",{value:"salida",children:"Salidas"})]}),(0,a.jsx)("input",{type:"number",name:"userId",placeholder:"ID Usuario (opcional)",value:e.userId,onChange:g,className:"input"}),(0,a.jsx)("input",{type:"text",name:"codigoitem",placeholder:"C\xf3digo del \xcdtem (opcional)",value:e.codigoitem,onChange:g,className:"input"}),(0,a.jsxs)("select",{name:"month",value:e.month,onChange:g,className:"input",children:[(0,a.jsx)("option",{value:"",children:"Todos los meses"}),m.map((e,n)=>n>0&&(0,a.jsx)("option",{value:n,children:e},n))]})]}),"resumen"===t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("select",{name:"mode",value:e.mode,onChange:g,className:"input",children:[(0,a.jsx)("option",{value:"month",children:"Por Mes"}),(0,a.jsx)("option",{value:"year",children:"Por A\xf1o"})]}),p&&(0,a.jsxs)("select",{name:"month",value:e.month,onChange:g,className:"input",children:[(0,a.jsx)("option",{value:"",children:"Mes"}),m.map((e,n)=>n>0&&(0,a.jsx)("option",{value:n,children:e},n))]})]}),(0,a.jsx)("input",{type:"number",name:"year",placeholder:"A\xf1o",value:e.year,onChange:g,className:"input"}),(0,a.jsx)("button",{className:"button-secondary",onClick:x,children:"Buscar"})]})]}),(0,a.jsxs)("div",{className:"table-container",children:[d&&(0,a.jsx)("p",{children:"Cargando datos..."}),!d&&0===o.length&&(0,a.jsx)("p",{children:"No se encontraron resultados."}),!d&&o.length>0&&(0,a.jsxs)(a.Fragment,{children:["asignacion-item"===t&&(0,a.jsxs)("table",{className:"styled-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"ID Usuario"}),(0,a.jsx)("th",{children:"Usuario"}),(0,a.jsx)("th",{children:"Sucursal"}),(0,a.jsx)("th",{children:"Precio Unitario (Bs.)"}),(0,a.jsx)("th",{children:"Cantidad Asignada"}),(0,a.jsx)("th",{children:"Total Invertido (Bs.)"}),(0,a.jsx)("th",{children:"\xcdtem"}),(0,a.jsx)("th",{children:"Mes"}),(0,a.jsx)("th",{children:"Imagen"})]})}),(0,a.jsx)("tbody",{children:o.map((e,n)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.user_id}),(0,a.jsx)("td",{children:e.usuario}),(0,a.jsx)("td",{children:e.sucursal||"No especificado"}),(0,a.jsxs)("td",{children:["Bs ",Number(e.precio_unitario).toFixed(2)]}),(0,a.jsx)("td",{children:e.cantidad_total_asignada}),(0,a.jsxs)("td",{children:["Bs ",Number(e.total_invertido).toFixed(2)]}),(0,a.jsx)("td",{children:e.item_name}),(0,a.jsx)("td",{children:e.mes||"Sin mes"}),(0,a.jsx)("td",{children:e.imagen_url?(0,a.jsx)("img",{src:"https://v14m7300-4000.brs.devtunnels.ms".concat(e.imagen_url),alt:"img",width:50}):(0,a.jsx)("span",{children:"Sin imagen"})})]},"".concat(e.user_id,"-").concat(n)))})]}),"detalle"===t&&(0,a.jsxs)("table",{className:"styled-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Usuario"}),(0,a.jsx)("th",{children:"\xcdtem"}),(0,a.jsx)("th",{children:"Modelo"}),(0,a.jsx)("th",{children:"Precio Unitario"}),(0,a.jsx)("th",{children:"Cantidad"}),(0,a.jsx)("th",{children:"Total"}),(0,a.jsx)("th",{children:"Mes"}),(0,a.jsx)("th",{children:"Fecha"}),(0,a.jsx)("th",{children:"Observaci\xf3n"})]})}),(0,a.jsx)("tbody",{children:o.map((e,n)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.nombre_completo}),(0,a.jsx)("td",{children:e.nombre_item}),(0,a.jsx)("td",{children:e.modelo}),(0,a.jsx)("td",{children:e.precio_unitario}),(0,a.jsx)("td",{children:e.cantidad}),(0,a.jsx)("td",{children:e.total_item}),(0,a.jsx)("td",{children:e.mes}),(0,a.jsx)("td",{children:e.fecha_salida}),(0,a.jsx)("td",{children:e.observacion})]},n))})]}),"completo"===t&&(0,a.jsxs)("table",{className:"styled-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Usuario"}),(0,a.jsx)("th",{children:"\xcdtem"}),(0,a.jsx)("th",{children:"Modelo"}),(0,a.jsx)("th",{children:"Precio Unitario"}),(0,a.jsx)("th",{children:"Cantidad"}),(0,a.jsx)("th",{children:"Total"}),(0,a.jsx)("th",{children:"Tipo"}),(0,a.jsx)("th",{children:"Mes"}),(0,a.jsx)("th",{children:"Fecha"}),(0,a.jsx)("th",{children:"Observaci\xf3n"})]})}),(0,a.jsx)("tbody",{children:o.map((e,n)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.nombre_usuario}),(0,a.jsx)("td",{children:e.nombre_item}),(0,a.jsx)("td",{children:e.modelo}),(0,a.jsx)("td",{children:e.precio_unitario}),(0,a.jsx)("td",{children:e.quantity}),(0,a.jsx)("td",{children:e.total_item}),(0,a.jsx)("td",{children:e.tipo_transaccion}),(0,a.jsx)("td",{children:e.mes}),(0,a.jsx)("td",{children:new Date(e.fecha).toLocaleDateString()}),(0,a.jsx)("td",{children:e.observacion})]},n))})]}),"resumen"===t&&(0,a.jsxs)("table",{className:"styled-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"ID Usuario"}),(0,a.jsx)("th",{children:"Nombre"}),(0,a.jsx)("th",{children:p?"Mes":"A\xf1o"}),(0,a.jsx)("th",{children:"Total Invertido (Bs.)"})]})}),(0,a.jsx)("tbody",{children:o.map((e,n)=>{var t;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.user_id}),(0,a.jsx)("td",{children:e.user_name}),(0,a.jsx)("td",{children:(null===(t=e.mes)||void 0===t?void 0:t.trim())||e.anio}),(0,a.jsx)("td",{children:Number(e.total_invertido).toLocaleString("es-BO",{style:"currency",currency:"BOB"})})]},n)})})]})]})]})]})};var o=t(4060);function c(){return(0,a.jsx)(o.A,{children:(0,a.jsxs)("div",{className:"reportes-container",children:[(0,a.jsx)("h1",{className:"titles",children:"REPORTES"}),(0,a.jsx)("div",{className:"report-card-wrapper",children:(0,a.jsx)(i,{})})]})})}},4060:(e,n,t)=>{"use strict";t.d(n,{A:()=>j});var a=t(5155),s=t(6046),r=t(2115),i=t(8173),o=t.n(i),c=t(9757),d=t(5055),l=t(5565);let h={src:"/_next/static/media/logo.3adaab63.png",height:100,width:100,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAARVBMVEX9/PzZdXj////9+fn55+hMaXHwz9D//////v7//f7svb/219v46On509X////RUlngkpXdgYb+8vPOTlX92dzVZGrprrIgseqOAAAADXRSTlMu+bXs/QD+rvH5/urq2zavewAAAAlwSFlzAAALEwAACxMBAJqcGAAAAD9JREFUeJwFwQkCgCAIAME1QdDCq+P/T20G5aj1QCE/IuFgke6RtuExxzu34/1bq/WMVSnFu8EZpckFirkb+gNMYwIfjEe+YgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8};t(3999);var u=t(6699),m=t.n(u);function p(e){let{children:n}=e,t=(0,s.usePathname)(),i=(0,s.useRouter)(),[u,p]=(0,r.useState)(""),[j,x]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=sessionStorage.getItem("name"),n=sessionStorage.getItem("lastname");e&&n&&p("".concat(e.toUpperCase()," ").concat(n.toUpperCase()))},[]);let g=()=>{window.innerWidth<768&&x(!1)};return(0,a.jsxs)("div",{className:"layout ".concat(m().className),children:[(0,a.jsxs)("div",{className:"header",children:[(0,a.jsxs)("div",{className:"header-left",children:[(0,a.jsx)(c.g,{icon:d.ckx,className:"menu-icon",onClick:()=>x(!j)}),(0,a.jsx)(l.default,{src:h,alt:"Logo Tornemec",className:"logo"}),(0,a.jsxs)("span",{className:"company-name",children:["TORNEMEC",(0,a.jsx)("small",{children:" SRL"})]})]}),(0,a.jsxs)("div",{className:"header-right",children:[(0,a.jsx)("span",{className:"user-name",children:u}),(0,a.jsx)(c.g,{icon:d.X46,className:"icon"}),(0,a.jsxs)("div",{className:"logout-container",onClick:()=>{confirm("\xbfSeguro que deseas cerrar sesi\xf3n?")&&(sessionStorage.clear(),i.push("/"))},children:[(0,a.jsx)(c.g,{icon:d.GxD,className:"logout-icon"}),(0,a.jsx)("span",{className:"logout-text",children:"CERRAR SESI\xd3N"})]})]})]}),(0,a.jsxs)("div",{className:"content",children:[(0,a.jsx)("div",{className:"sidebar ".concat(j?"open":""),children:(0,a.jsx)("div",{className:"fixed",children:(0,a.jsx)("nav",{children:(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{className:"sidebar-item ".concat("/inventory"===t?"active":""),children:(0,a.jsxs)(o(),{href:"/inventory",onClick:g,children:[(0,a.jsx)(c.g,{icon:d.KTq,className:"iconSidebar"}),(0,a.jsx)("span",{children:"Inventario"})]})}),(0,a.jsx)("li",{className:"sidebar-item ".concat("/store"===t?"active":""),children:(0,a.jsxs)(o(),{href:"/store",onClick:g,children:[(0,a.jsx)(c.g,{icon:d.LJS,className:"iconSidebar"}),(0,a.jsx)("span",{children:"Almac\xe9n"})]})}),(0,a.jsx)("li",{className:"sidebar-item ".concat("/users"===t?"active":""),children:(0,a.jsxs)(o(),{href:"/users",onClick:g,children:[(0,a.jsx)(c.g,{icon:d.gdJ,className:"iconSidebar"}),(0,a.jsx)("span",{children:"Usuarios"})]})}),(0,a.jsx)("li",{className:"sidebar-item ".concat("/report"===t?"active":""),children:(0,a.jsxs)(o(),{href:"/report",onClick:g,children:[(0,a.jsx)(c.g,{icon:d.h8M,className:"iconSidebar"}),(0,a.jsx)("span",{children:"Reporte"})]})})]})})})}),(0,a.jsx)("div",{className:"main-content",children:n})]})]})}function j(e){let{children:n}=e,t=(0,s.usePathname)(),i=(0,s.useRouter)(),[o,c]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{sessionStorage.getItem("isAuthenticated")||"/"===t?c(!1):i.push("/")},[t,i]),o)?(0,a.jsx)("p",{children:"Cargando..."}):"/"===t?(0,a.jsx)(a.Fragment,{children:n}):(0,a.jsx)(p,{children:n})}},5370:(e,n,t)=>{"use strict";t.d(n,{$O:()=>R,B_:()=>I,Dv:()=>f,F4:()=>N,Gq:()=>x,JS:()=>j,LD:()=>b,O0:()=>E,Op:()=>A,RG:()=>_,Rn:()=>S,TK:()=>u,bW:()=>y,fk:()=>v,hG:()=>p,ik:()=>U,kg:()=>h,kl:()=>m,lX:()=>k,lo:()=>l,p9:()=>C,pr:()=>d,qZ:()=>D,te:()=>w,wE:()=>g});let a="https://v14m7300-4000.brs.devtunnels.ms";async function s(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat(a,"/").concat(e);try{let e=await fetch(t,n),a=await e.json();return{status:e.status,data:a}}catch(e){throw console.error("Error en la solicitud:",e),e}}async function r(e){return s(e,{method:"GET"})}async function i(e,n){let t=n instanceof FormData;return s(e,{method:"POST",headers:t?void 0:{"Content-Type":"application/json"},body:t?n:JSON.stringify(n)})}async function o(e,n){let t=n instanceof FormData;return s(e,{method:"PUT",headers:t?void 0:{"Content-Type":"application/json"},body:t?n:JSON.stringify(n)})}async function c(e){return s(e,{method:"DELETE"})}async function d(e,n){return i("auth/login",{username:e,password:n})}async function l(){return r("activos")}async function h(e){return i("users",e)}let u=(e,n)=>{let t=n instanceof FormData;return fetch("".concat(a,"/users/").concat(e),{method:"PUT",headers:t?void 0:{"Content-Type":"application/json"},body:t?n:JSON.stringify(n)}).then(async e=>{let n=await e.json();if(!e.ok)throw Error(n.message||"Error al actualizar usuario");return{status:e.status,data:n}})},m=async e=>{let n=await fetch("https://v14m7300-4000.brs.devtunnels.ms/users/".concat(e));if(!n.ok)throw Error("No se pudo obtener el usuario");return n.json()};async function p(e){return c("users/".concat(e))}async function j(){return r("items")}async function x(e){return r("items/".concat(e))}async function g(e){return i("items",e)}async function v(e,n){return o("items/".concat(e),n)}async function b(e){return c("items/".concat(e))}async function y(e){return r("categories/".concat(e))}async function f(e){return r("stores/".concat(e))}async function N(){return r("machines")}async function I(e){return r("machines/".concat(e))}async function A(e){return i("machines",e)}async function w(e,n){return o("machines/".concat(e),n)}async function S(e){return c("machines/".concat(e))}async function C(){return r("branches")}async function E(){return r("roles")}let R=async e=>{let{userId:n,month:t,year:a,mode:s}=e,r=new URLSearchParams;n&&r.append("userId",n),t&&"month"===s&&r.append("month",t),a&&r.append("year",a),s&&r.append("mode",s);let i=await fetch("https://v14m7300-4000.brs.devtunnels.ms/api/transactions/report?".concat(r.toString()));if(!i.ok)throw Error("Error al obtener datos");return i.json()},k=async e=>{let n=await fetch("https://v14m7300-4000.brs.devtunnels.ms/api/transactions/report/item-movements?itemId=".concat(e));if(!n.ok)throw Error("No se pudo obtener el reporte de movimientos del \xedtem");return n.json()},D=async e=>{let{userId:n,month:t,year:s,codigoitem:r}=e,i=new URLSearchParams;n&&i.append("userId",n),t&&i.append("month",t),s&&i.append("year",s),r&&i.append("codigoitem",r);let o=await fetch("".concat(a,"/api/transactions/report/user-detailed?").concat(i.toString()));if(!o.ok)throw Error("No se pudo obtener el reporte detallado del usuario");return o.json()},_=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=new URLSearchParams(e).toString(),t=await fetch("https://v14m7300-4000.brs.devtunnels.ms/api/transactions/report/all-transactions?".concat(n));if(!t.ok)throw Error("No se pudo obtener el reporte completo");return t.json()},U=async(e,n,t,a,s)=>{let r=new URLSearchParams;n&&r.append("year",n),t&&r.append("month",t),a&&r.append("userid",a),s&&r.append("branchId",s);let i="https://v14m7300-4000.brs.devtunnels.ms/api/reportes/asignaciones/".concat(e,"?").concat(r.toString()),o=await fetch(i);if(!o.ok)throw Error("No se pudo obtener el reporte de asignaciones");return o.json()}},3999:()=>{},8019:()=>{}},e=>{var n=n=>e(e.s=n);e.O(0,[234,79,266,738,803,441,517,358],()=>n(1972)),_N_E=e.O()}]);