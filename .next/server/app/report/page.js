(()=>{var e={};e.id=81,e.ids=[81],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},9551:e=>{"use strict";e.exports=require("url")},6625:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>h,pages:()=>c,routeModule:()=>p,tree:()=>l});var n=t(260),s=t(8203),a=t(5155),i=t.n(a),o=t(7292),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);t.d(r,d);let l=["",{children:["report",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,5156)),"C:\\Users\\Ideapad\\OneDrive\\Documentos\\GitHub\\Deploy\\TornemecWebDeploy\\src\\app\\report\\page.jsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,2804)),"C:\\Users\\Ideapad\\OneDrive\\Documentos\\GitHub\\Deploy\\TornemecWebDeploy\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,1485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\Ideapad\\OneDrive\\Documentos\\GitHub\\Deploy\\TornemecWebDeploy\\src\\app\\report\\page.jsx"],h={require:t,loadChunk:()=>Promise.resolve()},p=new n.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/report/page",pathname:"/report",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},4892:(e,r,t)=>{Promise.resolve().then(t.bind(t,5156))},4620:(e,r,t)=>{Promise.resolve().then(t.bind(t,5243))},5243:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var n=t(5512),s=t(8009),a=t(62);t(1730);let i=()=>{let[e,r]=(0,s.useState)({userId:"",type:"",month:"",year:new Date().getFullYear(),mode:"month",codigoitem:"",branchId:""}),[t,i]=(0,s.useState)("resumen"),[o,d]=(0,s.useState)([]),[l,c]=(0,s.useState)(!1),[h,p]=(0,s.useState)([]),m=["","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],u="month"===e.mode,x=()=>{let r=new URLSearchParams;return e.userId&&r.append("userId",e.userId),e.year&&r.append("year",e.year),e.mode&&r.append("mode",e.mode),e.month&&"month"===e.mode&&r.append("month",e.month),e.type&&r.append("type",e.type),e.codigoitem&&r.append("codigoitem",e.codigoitem),e.branchId&&r.append("branchId",e.branchId),r},j=async()=>{c(!0);try{if("detalle"===t){if(!e.userId){alert("Debes ingresar un ID de usuario para ver el detalle."),c(!1);return}let r=await (0,a.qZ)({userId:e.userId,month:e.month,year:e.year,codigoitem:e.codigoitem,branchId:e.branchId});d(r)}else if("completo"===t){let r={userId:e.userId,codigoitem:e.codigoitem,month:e.month,year:e.year,type:e.type,branchId:e.branchId},t=await (0,a.RG)(r);d(t)}else if("asignacion-item"===t){if(!e.codigoitem){alert("Debes ingresar un c\xf3digo de \xedtem."),c(!1);return}let r=await (0,a.ik)(e.codigoitem,e.year,e.month,e.userId,e.branchId);d(r)}else{let{userId:e,codigoitem:r,...t}=Object.fromEntries(x()),n=await (0,a.$O)(t);d(n)}}catch(e){console.error("Error al obtener datos:",e)}finally{c(!1)}},b=t=>{r({...e,[t.target.name]:t.target.value})};return(0,s.useEffect)(()=>{let e=async()=>{try{let e=await fetch("https://v14m7300-4000.brs.devtunnels.ms/branches"),r=await e.json();p(r)}catch(e){console.error("Error al cargar sucursales:",e)}};d([]),j(),e()},[t]),(0,n.jsxs)("div",{className:"report-card",children:[(0,n.jsxs)("div",{className:"report-header",children:[(0,n.jsx)("h2",{className:"report-title",children:"asignacion-item"===t?"Reporte de Asignaci\xf3n por \xcdtem":"detalle"===t?"Reporte Detallado":"completo"===t?"Entradas y Salidas":u?"Reporte de Inversi\xf3n Mensual":"Reporte de Inversi\xf3n Anual"}),(0,n.jsxs)("div",{className:"report-actions",children:[(0,n.jsx)("button",{className:"button",onClick:()=>{let r="",n=new URLSearchParams;if("asignacion-item"===t){if(!e.codigoitem){alert("Debes ingresar un c\xf3digo de \xedtem para descargar el reporte.");return}r=`https://v14m7300-4000.brs.devtunnels.ms/api/reportes/asignaciones-excel/${e.codigoitem}`,e.year&&n.append("year",e.year),e.month&&n.append("month",e.month),e.userId&&n.append("userid",e.userId),e.branchId&&n.append("branchId",e.branchId)}else if("detalle"===t){if(!e.userId){alert("Debes ingresar un ID de usuario para descargar el detalle.");return}r="https://v14m7300-4000.brs.devtunnels.ms/api/transactions/download-user-detailed",n.append("userId",e.userId),e.month&&n.append("month",e.month),e.year&&n.append("year",e.year),e.codigoitem&&n.append("codigoitem",e.codigoitem),e.branchId&&n.append("branchId",e.branchId)}else"completo"===t?(r="https://v14m7300-4000.brs.devtunnels.ms/api/transactions/download-all-transactions",e.userId&&n.append("userId",e.userId),e.month&&n.append("month",e.month),e.year&&n.append("year",e.year),e.codigoitem&&n.append("codigoitem",e.codigoitem),e.type&&n.append("type",e.type),e.branchId&&n.append("branchId",e.branchId)):(r="https://v14m7300-4000.brs.devtunnels.ms/api/transactions/download-report",x().forEach((e,r)=>n.append(r,e)));window.open(`${r}?${n.toString()}`,"_blank")},children:"Descargar Reporte"}),"asignacion-item"===t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"text",name:"codigoitem",placeholder:"C\xf3digo del \xcdtem",value:e.codigoitem,onChange:b,className:"input"}),(0,n.jsx)("input",{type:"number",name:"userId",placeholder:"ID Usuario (opcional)",value:e.userId,onChange:b,className:"input"}),(0,n.jsxs)("select",{name:"branchId",value:e.branchId||"",onChange:b,className:"input",children:[(0,n.jsx)("option",{value:"",children:"Todas las sucursales"}),h.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,n.jsxs)("select",{name:"month",value:e.month,onChange:b,className:"input",children:[(0,n.jsx)("option",{value:"",children:"Todos los meses"}),m.map((e,r)=>r>0&&(0,n.jsx)("option",{value:r,children:e},r))]})]}),"detalle"===t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"number",name:"userId",placeholder:"ID Usuario",value:e.userId,onChange:b,className:"input"}),(0,n.jsx)("input",{type:"text",name:"codigoitem",placeholder:"C\xf3digo del \xcdtem (opcional)",value:e.codigoitem,onChange:b,className:"input"}),(0,n.jsxs)("select",{name:"month",value:e.month,onChange:b,className:"input",children:[(0,n.jsx)("option",{value:"",children:"Todos los meses"}),m.map((e,r)=>r>0&&(0,n.jsx)("option",{value:r,children:e},r))]})]}),(0,n.jsxs)("select",{value:t,onChange:e=>i(e.target.value),className:"input",children:[(0,n.jsx)("option",{value:"resumen",children:"Resumen"}),(0,n.jsx)("option",{value:"detalle",children:"Detalle"}),(0,n.jsx)("option",{value:"completo",children:"Entradas y Salidas"}),(0,n.jsx)("option",{value:"asignacion-item",children:"Asignaci\xf3n por \xcdtem"})]}),"completo"===t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("select",{name:"type",value:e.type,onChange:b,className:"input",children:[(0,n.jsx)("option",{value:"",children:"Todos"}),(0,n.jsx)("option",{value:"entrada",children:"Entradas"}),(0,n.jsx)("option",{value:"salida",children:"Salidas"})]}),(0,n.jsx)("input",{type:"number",name:"userId",placeholder:"ID Usuario (opcional)",value:e.userId,onChange:b,className:"input"}),(0,n.jsx)("input",{type:"text",name:"codigoitem",placeholder:"C\xf3digo del \xcdtem (opcional)",value:e.codigoitem,onChange:b,className:"input"}),(0,n.jsxs)("select",{name:"month",value:e.month,onChange:b,className:"input",children:[(0,n.jsx)("option",{value:"",children:"Todos los meses"}),m.map((e,r)=>r>0&&(0,n.jsx)("option",{value:r,children:e},r))]})]}),"resumen"===t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("select",{name:"mode",value:e.mode,onChange:b,className:"input",children:[(0,n.jsx)("option",{value:"month",children:"Por Mes"}),(0,n.jsx)("option",{value:"year",children:"Por A\xf1o"})]}),u&&(0,n.jsxs)("select",{name:"month",value:e.month,onChange:b,className:"input",children:[(0,n.jsx)("option",{value:"",children:"Mes"}),m.map((e,r)=>r>0&&(0,n.jsx)("option",{value:r,children:e},r))]})]}),(0,n.jsx)("input",{type:"number",name:"year",placeholder:"A\xf1o",value:e.year,onChange:b,className:"input"}),(0,n.jsx)("button",{className:"button-secondary",onClick:j,children:"Buscar"})]})]}),(0,n.jsxs)("div",{className:"table-container",children:[l&&(0,n.jsx)("p",{children:"Cargando datos..."}),!l&&0===o.length&&(0,n.jsx)("p",{children:"No se encontraron resultados."}),!l&&o.length>0&&(0,n.jsxs)(n.Fragment,{children:["asignacion-item"===t&&(0,n.jsxs)("table",{className:"styled-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"ID Usuario"}),(0,n.jsx)("th",{children:"Usuario"}),(0,n.jsx)("th",{children:"Sucursal"}),(0,n.jsx)("th",{children:"Precio Unitario (Bs.)"}),(0,n.jsx)("th",{children:"Cantidad Asignada"}),(0,n.jsx)("th",{children:"Total Invertido (Bs.)"}),(0,n.jsx)("th",{children:"\xcdtem"}),(0,n.jsx)("th",{children:"Mes"}),(0,n.jsx)("th",{children:"Imagen"})]})}),(0,n.jsx)("tbody",{children:o.map((e,r)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.user_id}),(0,n.jsx)("td",{children:e.usuario}),(0,n.jsx)("td",{children:e.sucursal||"No especificado"}),(0,n.jsxs)("td",{children:["Bs ",Number(e.precio_unitario).toFixed(2)]}),(0,n.jsx)("td",{children:e.cantidad_total_asignada}),(0,n.jsxs)("td",{children:["Bs ",Number(e.total_invertido).toFixed(2)]}),(0,n.jsx)("td",{children:e.item_name}),(0,n.jsx)("td",{children:e.mes||"Sin mes"}),(0,n.jsx)("td",{children:e.imagen_url?(0,n.jsx)("img",{src:`https://v14m7300-4000.brs.devtunnels.ms${e.imagen_url}`,alt:"img",width:50}):(0,n.jsx)("span",{children:"Sin imagen"})})]},`${e.user_id}-${r}`))})]}),"detalle"===t&&(0,n.jsxs)("table",{className:"styled-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Usuario"}),(0,n.jsx)("th",{children:"\xcdtem"}),(0,n.jsx)("th",{children:"Modelo"}),(0,n.jsx)("th",{children:"Precio Unitario"}),(0,n.jsx)("th",{children:"Cantidad"}),(0,n.jsx)("th",{children:"Total"}),(0,n.jsx)("th",{children:"Mes"}),(0,n.jsx)("th",{children:"Fecha"}),(0,n.jsx)("th",{children:"Observaci\xf3n"})]})}),(0,n.jsx)("tbody",{children:o.map((e,r)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.nombre_completo}),(0,n.jsx)("td",{children:e.nombre_item}),(0,n.jsx)("td",{children:e.modelo}),(0,n.jsx)("td",{children:e.precio_unitario}),(0,n.jsx)("td",{children:e.cantidad}),(0,n.jsx)("td",{children:e.total_item}),(0,n.jsx)("td",{children:e.mes}),(0,n.jsx)("td",{children:e.fecha_salida}),(0,n.jsx)("td",{children:e.observacion})]},r))})]}),"completo"===t&&(0,n.jsxs)("table",{className:"styled-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Usuario"}),(0,n.jsx)("th",{children:"\xcdtem"}),(0,n.jsx)("th",{children:"Modelo"}),(0,n.jsx)("th",{children:"Precio Unitario"}),(0,n.jsx)("th",{children:"Cantidad"}),(0,n.jsx)("th",{children:"Total"}),(0,n.jsx)("th",{children:"Tipo"}),(0,n.jsx)("th",{children:"Mes"}),(0,n.jsx)("th",{children:"Fecha"}),(0,n.jsx)("th",{children:"Observaci\xf3n"})]})}),(0,n.jsx)("tbody",{children:o.map((e,r)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.nombre_usuario}),(0,n.jsx)("td",{children:e.nombre_item}),(0,n.jsx)("td",{children:e.modelo}),(0,n.jsx)("td",{children:e.precio_unitario}),(0,n.jsx)("td",{children:e.quantity}),(0,n.jsx)("td",{children:e.total_item}),(0,n.jsx)("td",{children:e.tipo_transaccion}),(0,n.jsx)("td",{children:e.mes}),(0,n.jsx)("td",{children:new Date(e.fecha).toLocaleDateString()}),(0,n.jsx)("td",{children:e.observacion})]},r))})]}),"resumen"===t&&(0,n.jsxs)("table",{className:"styled-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"ID Usuario"}),(0,n.jsx)("th",{children:"Nombre"}),(0,n.jsx)("th",{children:u?"Mes":"A\xf1o"}),(0,n.jsx)("th",{children:"Total Invertido (Bs.)"})]})}),(0,n.jsx)("tbody",{children:o.map((e,r)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.user_id}),(0,n.jsx)("td",{children:e.user_name}),(0,n.jsx)("td",{children:e.mes?.trim()||e.anio}),(0,n.jsx)("td",{children:Number(e.total_invertido).toLocaleString("es-BO",{style:"currency",currency:"BOB"})})]},r))})]})]})]})]})};var o=t(8721);function d(){return(0,n.jsx)(o.A,{children:(0,n.jsxs)("div",{className:"reportes-container",children:[(0,n.jsx)("h1",{className:"titles",children:"REPORTES"}),(0,n.jsx)("div",{className:"report-card-wrapper",children:(0,n.jsx)(i,{})})]})})}},5156:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n});let n=(0,t(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Ideapad\\\\OneDrive\\\\Documentos\\\\GitHub\\\\Deploy\\\\TornemecWebDeploy\\\\src\\\\app\\\\report\\\\page.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Ideapad\\OneDrive\\Documentos\\GitHub\\Deploy\\TornemecWebDeploy\\src\\app\\report\\page.jsx","default")},1730:()=>{}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[638,403,270,442,0],()=>t(6625));module.exports=n})();