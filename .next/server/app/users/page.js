(()=>{var e={};e.id=9,e.ids=[9],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},9551:e=>{"use strict";e.exports=require("url")},317:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>d,routeModule:()=>u,tree:()=>c});var r=a(260),l=a(8203),t=a(5155),n=a.n(t),i=a(7292),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);a.d(s,o);let c=["",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,748)),"C:\\Users\\Ideapad\\OneDrive\\Documentos\\GitHub\\Deploy\\TornemecWebDeploy\\src\\app\\users\\page.jsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,2804)),"C:\\Users\\Ideapad\\OneDrive\\Documentos\\GitHub\\Deploy\\TornemecWebDeploy\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,1485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\Users\\Ideapad\\OneDrive\\Documentos\\GitHub\\Deploy\\TornemecWebDeploy\\src\\app\\users\\page.jsx"],m={require:a,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:l.RouteKind.APP_PAGE,page:"/users/page",pathname:"/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},628:(e,s,a)=>{Promise.resolve().then(a.bind(a,748))},6660:(e,s,a)=>{Promise.resolve().then(a.bind(a,373))},373:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>p});var r=a(5512),l=a(8009);a(5517);var t=a(8073),n=a(4803);let i=({user:e,onEdit:s,onDelete:a})=>{let{id:l,name:i,lastname:o,username:c,phone:d,role:m,image:u}=e;return(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"imageContainer",children:(0,r.jsx)("img",{src:`https://v14m7300-4000.brs.devtunnels.ms${u}`,alt:"Usuario",width:"300"})}),(0,r.jsxs)("div",{className:"details",children:[(0,r.jsx)("h3",{className:"title",children:i+" "+o}),(0,r.jsxs)("div",{className:"row",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Usuario: "})," ",c]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Celular: "})," ",d]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Rol: "})," ",m]})]}),(0,r.jsxs)("div",{className:"form-buttons",style:{display:"flex",gap:"5px",justifyContent:"center",padding:"10px"},children:[(0,r.jsxs)("button",{className:"form-button-primary",style:{flex:1,minWidth:"100px",padding:"8px 12px"},onClick:()=>s(l),children:[(0,r.jsx)(t.g,{icon:n.MT7})," Editar"]}),(0,r.jsxs)("button",{className:"form-button-primary",style:{flex:1,minWidth:"100px",padding:"8px 12px"},onClick:()=>a(l),children:[(0,r.jsx)(t.g,{icon:n.BeE})," Eliminar"]})]})]})]})};var o=a(62);function c({onClose:e,onUserRegistered:s}){let[a,t]=(0,l.useState)({name:"",lastname:"",secondlastname:"",image:null,rolId:"",branchId:"",phone:"",email:""}),[n,i]=(0,l.useState)([]),[c,d]=(0,l.useState)([]),[m,u]=(0,l.useState)(!0),p=e=>{let{name:s,value:a}=e.target;t(e=>({...e,[s]:""===a?null:a}))},h=async r=>{if(r.preventDefault(),!a.name||!a.lastname||!a.rolId||!a.branchId){alert("Por favor completa todos los campos obligatorios.");return}if(!/^\d{8}$/.test(a.phone)){alert("El n\xfamero de celular debe tener 8 d\xedgitos.");return}let l=new FormData;Object.entries(a).forEach(([e,s])=>{"image"!==e&&l.append(e,s)}),a.image&&l.append("image",a.image.file);try{let a=await (0,o.kg)(l);201===a.status?(alert("Registro exitoso âœ…"),s(),e()):alert("Hubo un error al registrar el usuario.")}catch(e){console.error("Error al enviar los datos:",e),alert("Hubo un error al enviar los datos.")}};return(0,r.jsxs)("div",{className:"create-item-container",children:[(0,r.jsx)("h2",{className:"form-title",children:"REGISTRO DE USUARIO"}),(0,r.jsxs)("form",{className:"form",onSubmit:h,children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsxs)("label",{className:"form-label",children:["Nombre: ",(0,r.jsx)("span",{className:"required",children:"*"})]}),(0,r.jsx)("input",{type:"text",name:"name",value:a.name||"",onChange:p,className:"form-input",required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsxs)("label",{className:"form-label",children:["Primer Apellido: ",(0,r.jsx)("span",{className:"required",children:"*"})]}),(0,r.jsx)("input",{type:"text",name:"lastname",value:a.lastname||"",onChange:p,className:"form-input",required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Segundo Apellido:"}),(0,r.jsx)("input",{type:"text",name:"secondlastname",value:a.secondlastname||"",onChange:p,className:"form-input"})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsxs)("label",{className:"form-label",children:["Celular: ",(0,r.jsx)("span",{className:"required",children:"*"})]}),(0,r.jsx)("input",{type:"text",name:"phone",value:a.phone||"",onChange:p,className:"form-input",required:!0})]}),!(()=>{let e=n.find(e=>e.id===a.rolId);return e?.name.toLowerCase()==="trabajador"})()&&(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Gmail:"}),(0,r.jsx)("input",{type:"email",name:"email",value:a.email||"",onChange:p,className:"form-input"})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsxs)("label",{className:"form-label",children:["Rol: ",(0,r.jsx)("span",{className:"required",children:"*"})]}),(0,r.jsxs)("select",{name:"rolId",value:a.rolId||"",onChange:p,className:"form-select",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Selecciona un Rol"}),n.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsxs)("label",{className:"form-label",children:["Sucursal: ",(0,r.jsx)("span",{className:"required",children:"*"})]}),(0,r.jsxs)("select",{name:"branchId",value:a.branchId||"",onChange:p,className:"form-select",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Selecciona una Sucursal"}),c.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Imagen:"}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let s=e.target.files[0];s&&t(e=>({...e,image:{file:s,url:URL.createObjectURL(s)}}))},className:"form-input"})]}),a.image&&(0,r.jsx)("div",{className:"image-preview-container",children:(0,r.jsxs)("div",{className:"image-preview-item",children:[(0,r.jsx)("img",{src:a.image.url,alt:"Imagen seleccionada",style:{width:"100px",height:"100px",objectFit:"cover"}}),(0,r.jsx)("button",{type:"button",className:"remove-image-button",onClick:()=>{t(e=>({...e,image:null}))},children:"X"})]})}),(0,r.jsxs)("div",{className:"form-buttons",children:[(0,r.jsx)("button",{type:"submit",className:"form-button form-button-primary",children:"Registrar"}),(0,r.jsx)("button",{type:"button",className:"form-button form-button-secondary",onClick:e,children:"Cancelar"})]})]})]})}function d({userId:e,onClose:s,onUserUpdated:a}){let[t,n]=(0,l.useState)({name:"",lastname:"",secondlastname:"",username:"",phone:"",rolid:"",branchid:"",state:1}),[i,c]=(0,l.useState)([]),[d,m]=(0,l.useState)([]),[u,p]=(0,l.useState)([]),[h,x]=(0,l.useState)([]),j=e=>{let{name:s,value:a}=e.target;n(e=>({...e,[s]:a}))},b=e=>{p(s=>s.filter(s=>s.id!==e))},v=e=>{x(s=>s.filter((s,a)=>a!==e))},f=async r=>{r.preventDefault();let l=new FormData;Object.entries(t).forEach(([e,s])=>{null!=s&&l.append(e,s)}),h.forEach(({file:e})=>{l.append("images",e)});let n=u.map(e=>e.id);l.append("existingImages",JSON.stringify(n));try{let r=await (0,o.TK)(e,l);200===r.status?(alert("Usuario actualizado correctamente"),a(),s()):alert("Error al actualizar usuario")}catch(e){console.error("Error:",e),alert("Error de red o del servidor")}};return(0,r.jsxs)("div",{className:"create-item-container",children:[(0,r.jsx)("h2",{className:"form-title",children:"Editar Usuario"}),(0,r.jsxs)("form",{className:"form",onSubmit:f,children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Nombre:"}),(0,r.jsx)("input",{name:"name",value:t.name,onChange:j,required:!0,className:"form-input"})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Primer Apellido:"}),(0,r.jsx)("input",{name:"lastname",value:t.lastname,onChange:j,required:!0,className:"form-input"})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Segundo Apellido:"}),(0,r.jsx)("input",{name:"secondlastname",value:t.secondlastname,onChange:j,className:"form-input"})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Celular:"}),(0,r.jsx)("input",{name:"phone",value:t.phone,onChange:j,required:!0,className:"form-input"})]}),!(()=>{let e=i.find(e=>e.id===t.rolid);return e?.name.toLowerCase()==="trabajador"})()&&(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Rol:"}),(0,r.jsxs)("select",{name:"rolid",value:t.rolid,onChange:j,className:"form-input",children:[(0,r.jsx)("option",{value:"",children:"Rol"}),i.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Sucursal:"}),(0,r.jsxs)("select",{name:"branchid",value:t.branchid,onChange:j,className:"form-input",children:[(0,r.jsx)("option",{value:"",children:"Sucursal"}),d.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{className:"form-label",children:"Cambiar Foto:"}),(0,r.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{let s=Array.from(e.target.files).map(e=>({file:e,url:URL.createObjectURL(e)}));x(e=>[...e,...s])},className:"form-input"})]}),(0,r.jsxs)("div",{className:"preview-container",children:[h.map(({url:e},s)=>(0,r.jsxs)("div",{className:"preview-item",children:[(0,r.jsx)("img",{src:e,alt:`Preview ${s}`,className:"preview-media"}),(0,r.jsx)("button",{type:"button",className:"remove-button",onClick:()=>v(s),children:"X"})]},s)),u.map((e,s)=>(0,r.jsxs)("div",{className:"preview-item",children:[(0,r.jsx)("img",{src:e.url,alt:`Imagen existente ${s}`,className:"preview-media"}),(0,r.jsx)("button",{type:"button",className:"remove-button",onClick:()=>b(e.id),children:"X"})]},e.id||s))]}),(0,r.jsxs)("div",{className:"form-buttons",children:[(0,r.jsx)("button",{type:"submit",className:"form-button form-button-primary",children:"Actualizar"}),(0,r.jsx)("button",{type:"button",className:"form-button form-button-secondary",onClick:s,children:"Cancelar"})]})]})]})}function m({userId:e,onClose:s,onUserDeleted:a}){let l=async()=>{try{let r=await (0,o.hG)(e);200===r.status?(alert("Usuario eliminado correctamente"),a(),s()):alert("No se pudo eliminar el usuario")}catch(e){console.error("Error al eliminar usuario:",e),alert("Hubo un error al eliminar el usuario")}};return(0,r.jsxs)("div",{className:"create-item-container",children:[(0,r.jsx)("h2",{className:"form-title",children:"\xbfDesea Eliminar el Registro?"}),(0,r.jsx)("form",{className:"form",onSubmit:l,children:(0,r.jsxs)("div",{className:"form-buttons",children:[(0,r.jsx)("button",{type:"submit",className:"form-button form-button-primary",children:"Aceptar"}),(0,r.jsx)("button",{type:"button",className:"form-button form-button-secondary",onClick:s,children:"Cancelar"})]})})]})}a(5881),a(1678);var u=a(8721);function p(){let[e,s]=(0,l.useState)(!1),[a,p]=(0,l.useState)(!1),[h,x]=(0,l.useState)(!1),[j,b]=(0,l.useState)(null),[v,f]=(0,l.useState)([]),[N,g]=(0,l.useState)(!0),[y,C]=(0,l.useState)(null),[w,S]=(0,l.useState)("cards"),[D,E]=(0,l.useState)(""),[I,k]=(0,l.useState)(""),U=async()=>{try{let e=await (0,o.lo)();if(e.data){let s=e.data.sort((e,s)=>e.id-s.id);f(s)}else f([])}catch(e){C(e.message)}finally{g(!1)}},R=e=>{b(e),p(!0)},q=e=>{b(e),x(!0)},P=v.filter(e=>{let s=(e.name+" "+e.lastname).toLowerCase(),a=e.username.toLowerCase(),r=D.toLowerCase(),l=s.includes(r)||a.includes(r),t=""===I||e.role===I;return l&&t}),A=[...new Set(v.map(e=>e.role))];return(0,r.jsx)(u.A,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"titles",children:"USUARIOS"}),(0,r.jsxs)("div",{className:"almacen-header",children:[(0,r.jsx)("button",{onClick:()=>s(!0),className:"new-item-button",children:"Nuevo Usuario"}),(0,r.jsxs)("div",{className:"view-switch",children:[(0,r.jsx)("button",{className:`view-button ${"cards"===w?"active":""}`,onClick:()=>S("cards"),children:"Tarjetas"}),(0,r.jsx)("button",{className:`view-button ${"table"===w?"active":""}`,onClick:()=>S("table"),children:"Tabla"})]}),(0,r.jsxs)("div",{className:"search-container",children:[(0,r.jsx)(t.g,{icon:n.MjD,className:"search-icon"}),(0,r.jsx)("input",{type:"text",className:"search-bar",placeholder:"Buscar...",value:D,onChange:e=>E(e.target.value)})]}),(0,r.jsx)("div",{className:"search-container",style:{marginLeft:"10px"},children:(0,r.jsxs)("select",{className:"search-bar",value:I,onChange:e=>k(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Todos los Roles"}),A.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})})]}),e&&(0,r.jsx)("div",{className:"modal-overlay",children:(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsx)("button",{onClick:()=>s(!1),className:"close-button",children:"\xd7"}),(0,r.jsx)(c,{onClose:()=>s(!1),onUserRegistered:U})]})}),a&&(0,r.jsx)("div",{className:"modal-overlay",children:(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsx)("button",{onClick:()=>p(!1),className:"close-button",children:"\xd7"}),(0,r.jsx)(d,{userId:j,onClose:()=>p(!1),onUserUpdated:U})]})}),h&&(0,r.jsx)("div",{className:"modal-overlay",children:(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsx)("button",{onClick:()=>x(!1),className:"close-button",children:"\xd7"}),(0,r.jsx)(m,{userId:j,onClose:()=>x(!1),onUserDeleted:U})]})}),(0,r.jsx)("div",{className:"outerContainer",children:"cards"===w?(0,r.jsx)("div",{className:"innerContainer",children:P.map(e=>(0,r.jsx)(i,{user:e,onEdit:R,onDelete:q},e.id))}):(0,r.jsx)("div",{className:"table-wrapper",children:(0,r.jsxs)("table",{className:"styled-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Nombre"}),(0,r.jsx)("th",{children:"Nombre Usuario"}),(0,r.jsx)("th",{children:"Celular"}),(0,r.jsx)("th",{children:"Rol"}),(0,r.jsx)("th",{children:"Acciones"})]})}),(0,r.jsx)("tbody",{children:P.map((e,s)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:s+1}),(0,r.jsxs)("td",{children:[e.name," ",e.lastname]}),(0,r.jsx)("td",{children:e.username}),(0,r.jsx)("td",{children:e.phone}),(0,r.jsx)("td",{children:e.role}),(0,r.jsxs)("td",{children:[(0,r.jsxs)("button",{className:"form-button-primary",style:{minWidth:"100px",padding:"8px 12px",marginRight:"2px"},onClick:()=>R(e.id),children:[(0,r.jsx)(t.g,{icon:n.MT7})," Editar"]}),(0,r.jsxs)("button",{className:"form-button-primary",style:{minWidth:"100px",padding:"8px 12px"},onClick:()=>q(e.id),children:[(0,r.jsx)(t.g,{icon:n.BeE})," Eliminar"]})]})]},e.id))})]})})})]})})}},748:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>r});let r=(0,a(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Ideapad\\\\OneDrive\\\\Documentos\\\\GitHub\\\\Deploy\\\\TornemecWebDeploy\\\\src\\\\app\\\\users\\\\page.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Ideapad\\OneDrive\\Documentos\\GitHub\\Deploy\\TornemecWebDeploy\\src\\app\\users\\page.jsx","default")},5517:()=>{},1678:()=>{},5881:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),r=s.X(0,[638,403,270,442,0],()=>a(317));module.exports=r})();